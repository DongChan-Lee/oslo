Search.setIndex({docnames:["CONFIGURATION/activation_checkpointing","CONFIGURATION/kernel_fusion","CONFIGURATION/model_parallelism","index","tutorials/activation_checkpointing","tutorials/kernel_fusion","tutorials/tensor_model_data_parallelism","tutorials/tensor_model_parallelism","tutorials/tensor_model_zero_data_parallelism"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["CONFIGURATION/activation_checkpointing.md","CONFIGURATION/kernel_fusion.md","CONFIGURATION/model_parallelism.md","index.rst","tutorials/activation_checkpointing.md","tutorials/kernel_fusion.md","tutorials/tensor_model_data_parallelism.md","tutorials/tensor_model_parallelism.md","tutorials/tensor_model_zero_data_parallelism.md"],objects:{},objnames:{},objtypes:{},terms:{"0a2":[],"100":[6,7,8],"1024":4,"128":4,"1885042190551758":5,"19448089599609375":5,"2021":3,"2022":3,"20798110961914062":5,"256":5,"25797200202941895":5,"26519250869750977":5,"45142364501953125":5,"4gpu":7,"5e8":8,"681gib":4,"8594":4,"break":[4,6,7,8],"case":5,"default":[0,1,2,5],"function":[5,6,8],"import":[3,4,5,6,7,8],"long":5,"true":[4,5,6,7,8],"while":8,ARE:[6,8],Added:3,And:[6,7,8],But:8,For:[4,6,7,8],NOT:[6,8],The:[2,3,4,5,7],Then:7,There:7,USE:[6,8],abl:5,about:[4,6],access:[6,8],activ:[3,5],activation_checkpoint:[0,4],actual:[6,8],adam:[4,6,7,8],add:[4,6,7,8],adding:8,addit:[7,8],after:[6,7,8],agenc:3,aica:3,albert:2,all:[2,3,5,6,8],allgather_bucket_s:8,allgather_partit:8,almost:2,alpha:3,alreadi:[4,6,8],also:[5,7],apach:3,appli:[6,8],architectur:5,area:5,argument:[6,7,8],artifici:3,author:3,automat:[3,6,8],automodelforcausallm:[4,6,7,8],autotoken:[4,6,7,8],avail:[0,1,4,5],avoid:4,backward:[4,5,6,7,8],bart:2,base:[3,4],batch:[1,4,5,6,7,8],batch_siz:[4,5,6,7,8],becaus:[5,6,7,8],begin:[6,8],being:3,bench:5,bert:2,better:5,bin:[6,7,8],bit:[6,7,8],block:[1,5],boost:5,borrow:[6,8],bug:5,built:3,call:[4,5,6,8],can:[0,1,2,3,4,5,6,7,8],care:3,chang:4,check:8,checkpoint:[3,5],christma:7,classif:7,cluster:3,cocept:[],code:[3,4,5,6,7,8],com:3,command:3,commun:[6,8],compar:5,compat:[3,5],comput:5,concept:7,conclud:[4,5,6,7,8],config:[3,4,5,6,7,8],configur:[0,1,2],consid:3,constantli:8,context:[4,6,7,8],contigu:[0,4],contiguous_checkpoint:4,contiguous_gradi:8,continu:5,coordin:[6,8],copi:[6,8],copyright:3,core:3,could:[3,5,8],cpu:[0,4,8],cpu_checkpoint:4,crate:[6,7,8],creation:[6,7,8],cuda:[1,4,6,7,8],current:[1,2,5],current_devic:6,cusom:5,custom:1,custom_cuda_kernel:5,cut:5,data:7,dataload:4,ddp:[6,8],decemb:3,decod:7,deepspe:[4,6,7,8],deepspeed_param:[],degre:2,depend:[3,5],deploy:3,describ:4,detail:2,determin:[6,8],develop:5,devic:[6,8],device_id:6,didn:5,differ:[5,6,8],distributeddataparallel:6,document:[4,6,7,8],doesn:[4,6,7,8],don:[2,7],each:[6,8],easi:3,easier:5,easili:[3,6,8],effect:[1,5],effici:[1,4],electra:2,eleutherai:3,enabl:[5,6,7,8],engin:[4,5,6,8],enumer:[4,6,7,8],environ:[4,6,7,8],eos_token:[4,6,7,8],error:8,exampl:[5,7],execut:[1,5],expand:5,experiment:5,explan:[6,8],face:[3,4,6,7,8],facilit:[6,8],fact:5,facto:3,fairscal:[],fals:[0,1,2,4,6,8],famailar:8,familiar:[],faster:5,featur:[3,8],februari:3,feel:3,file:7,find:[2,3],finish:[6,8],first:[4,6,8],follow:[1,2,3,4,5,6,7,8],form:[6,7,8],forward:[4,6,7,8],found:[4,5,6,7,8],fp16:8,fragment:4,framework:[],free:3,from:[2,3,4,5,6,7,8],from_parallel:[6,7,8],from_pretrain:[4,5,6,7,8],functorch:5,fusedgelu:5,fusednorepeatngram:[1,5],fusedrmsnorm:[1,5],fusibl:5,fusion:3,futur:[2,5],gain:5,gener:[1,5,7],generationmixin:5,get_data_parallel_group:[6,8],get_data_parallel_rank:[6,8],get_data_parallel_world_s:[6,8],get_pipeline_parallel_group:[6,8],get_pipeline_parallel_rank:[6,8],get_pipeline_parallel_world_s:[6,8],get_rank:4,get_tensor_parallel_group:[6,8],get_tensor_parallel_rank:[6,8],get_tensor_parallel_world_s:[6,8],gib:4,github:3,gpt2:[2,4,5,6,7,8],gpt2config:[6,7,8],gpt2lmheadmodel:[5,6,7,8],gpt:3,gptj:2,gptneo:2,gpu:[1,2,3,4,5,6,7,8],gradient_checkpointing_en:4,graph:5,greater:7,group:[6,8],handcraft:5,has:[5,6,8],have:[4,6,7,8],haven:[4,6,8],head:7,here:[2,4,5,6,7,8],hidden:7,how:[4,5,6,7,8],howev:[5,6,7,8],howpublish:3,http:3,hug:[3,4,6,7,8],huge:5,hyunwoong:3,implement:4,improv:5,inc:3,includ:[2,5,6,8],incompat:5,industri:3,infer:[3,5],inform:[4,6,7,8],initi:3,input:[6,7,8],input_batch:[4,6,7,8],input_id:[4,6,7,8],input_tensor:5,insid:[6,8],instal:[4,6,7,8],instead:4,integr:4,intellig:3,introduc:[6,8],issu:[5,8],its:[6,8],januari:3,json:[3,6,7,8],just:[6,7,8],kei:3,kernel:3,kernel_fus:[1,5],kim:3,know:2,kyubyong:3,label:[4,6,7,8],larg:[1,5],larger:4,later:[6,8],launch:[4,6,7,8],launcher:3,lee:3,let:[6,8],librari:[4,6,7,8],like:[0,1,2,3,4,5,6,7,8],likewis:7,line:3,list:2,load_dataset:[4,6,7,8],loader:[6,7,8],local:[6,7,8],look:[6,8],loss:[4,6,7,8],lot:7,magic:3,mai:5,make:[3,4,5,7],manag:[3,6,8],mani:5,mark:5,mask:7,max_length:[4,6,7,8],mean:2,mechan:[5,6,8],megatron:[6,8],memori:[1,4],memory_alloc:4,memory_efficient_fus:5,merge_checkpoint:[6,7,8],merged_ckpt:[6,7,8],method:[5,6,7,8],min:5,misc:3,mix:[6,8],model:[0,3],model_parallel:[2,4,6,7,8],model_paramet:8,modul:6,more:[4,5,6,7,8],most:[4,5,8],much:5,multipl:[4,6,8],must:[2,4,6,7,8],name:[3,5,6,7,8],network:[6,8],ngram:[1,5],nice:[6,8],no_repeat_ngram_s:5,non:5,non_oslo_model:5,note:[0,2,4,5,6,8],novel:5,now:[3,6,8],nproc_per_nod:[4,6,7,8],num:[6,8],num_beam:7,num_gpu:[4,6,7,8],num_replica:[6,8],num_your_gpu:[6,7,8],number:[2,7],nvidia:[6,8],object:[6,8],occur:[5,8],off:[6,8],offload:4,offload_optim:8,offload_param:8,okai:[6,7,8],one:7,ones:5,onli:[0,3,4,5,6,8],open:[],optim:5,oslo:[5,6,7,8],oslo_model:5,other:5,our:[3,5],output_devic:6,overlap_comm:8,own:[0,1,2,6,8],packag:[3,4],pad:[4,6,7,8],pad_token:[4,6,7,8],paper:4,parallel:[0,3,5],parallel_ckpt:[6,7,8],param:8,paramet:[4,6,7,8],park:3,part:[4,5],partit:[0,4],partitioned_checkpoint:4,path:[6,7,8],perform:5,piec:[6,8],pip:3,pipelin:[6,8],pipeline_parallel_s:[6,8],place:[6,8],pleas:[3,4,5,6,8],polici:5,posit:[2,7],possibl:5,power:[2,5,7],previou:[6,8],print:[4,5,7],process:[6,7,8],process_group:6,project:3,provid:[3,5,6,8],pypi:3,python:[4,6,7,8],pytorch:[5,6,7,8],pytorch_model:[6,7,8],pytorch_model_tp_0_pp_0:7,randomli:[6,7,8],rang:5,rank:[6,8],rather:5,read:[4,6,8],readi:[6,8],reason:[6,8],receiv:[6,8],recommend:[6,7,8],reduce_bucket_s:8,reduce_scatt:8,refer:[4,6,7,8],relat:[0,1,2],releas:3,remateri:5,replic:[6,8],report:[5,8],requir:5,reserv:3,respect:[6,8],result:[4,5,6,8],return_tensor:[4,6,7,8],right:3,rmsnorm:[1,5],roberta:2,round:4,rule:2,runtim:5,same:[2,4,5,6,7,8],save:[4,6,8],save_directori:[6,7,8],save_interv:[6,7,8],save_parallel:[6,7,8],save_pretrain:7,scale:[],scenario:5,schedul:8,script:5,section:[5,6,8],see:4,seen:[6,8],segment:[6,8],select:[],send:[6,8],seq_len:[4,5,6,7,8],sequenc:7,set:[5,6,7,8],sever:5,should:[3,5,6,8],show:5,shuffl:[4,6,7,8],similar:7,simpl:5,singl:[3,6,8],size:[2,4,6,7,8],skip:[6,8],slow:[6,7,8],smaller:[2,6,7,8],some:2,soohwan:3,sourc:[4,5,6,7,8],special:[6,7,8],specif:5,specifi:[0,1,2,6,8],speed:5,split:[6,8],squad:[4,6,7,8],stage:8,standard:3,start:5,step:[4,6,7,8],still:5,str:[4,6,7,8],support:[1,3,6,7,8],suppos:[6,8],t5forconditionalgener:5,take:[3,6,8],task:7,team:5,technolog:[3,5],tensor:[0,2,4],tensor_parallel_s:[4,6,7,8],term:3,text:[1,5,7],than:[2,5,6,7,8],thank:[4,5,6,7,8],thei:[6,8],them:[6,7,8],therefor:[6,8],thi:[0,2,4,5,6,7,8],thing:7,through:8,time:[5,6,8],titl:3,togeth:8,torch:[3,4,5,6,7,8],total:[2,6,7,8],total_num_step:8,tracker:5,train:[3,5],train_batch_s:8,train_step:[4,6,7,8],transform:[4,5,6,7,8],truncat:[4,6,7,8],tunib:3,ture:[6,7,8],turn:[6,8],twice:4,two:[5,6,8],type:[0,1,2,8],under:[0,1,2,3,5],unexpect:5,unfamiliar:[4,6,8],url:3,use:[1,3,4,5,6,7,8],use_cach:4,used:[4,5,6,7,8],useful:3,uses:5,using:[0,1,3,4,5,6,7,8],util:[4,6,7,8],vari:5,variou:[3,7,8],veri:[1,5],version:3,want:[5,7],warmup_max_lr:8,warmup_min_lr:8,warmup_num_step:8,warmupdecaylr:8,weight_decai:8,what:2,when:[0,1,3,4,5,6,8],which:3,without:4,work:[3,4,6,7,8],world:[6,8],would:[6,8],write:7,www:3,year:3,yohan:3,you:[0,1,2,3,4,5,6,7,8],you_tensor_parallel_s:[],your:[0,1,2,4,5,6,7,8],your_script:[4,6,7,8],your_tensor_parallel_s:[4,6,8],zero:[],zero_grad:[4,6,7,8],zero_optim:8},titles:["Activation Checkpointing","Kernel Fusion","Model Parallelism","OSLO: Open Source framework for Large-scale transformer Optimization","Activation Checkpointing Tutorial","Kernel Fusion Tutorial","Tensor Model + Data Parallelism Tutorial","Tensor Model Parallelism Tutorial","Tensor Model + ZeRO Data Parallelism Tutorial"],titleterms:{"int":2,"new":3,The:[6,8],about:3,acknowledg:3,activ:[0,4],administr:3,aot:5,autograd:5,backend:[],base:5,basic:3,benchmark:5,bool:[0,1,2],checkpoint:[0,4,6,7,8],cite:3,compil:5,concept:[6,8],configur:3,content:[4,5,6,7,8],contiguous_checkpoint:0,cpu_checkpoint:0,creat:[4,5,6,7,8],cuda:5,custom:5,custom_cuda_kernel:1,data:[4,6,8],dataload:[6,7,8],dataset:[4,6,7,8],dict:[],dimension:[6,8],distribut:[4,6,7,8],distributedsampl:[6,8],document:3,effici:5,enabl:[0,1,2,4],fairscale_param:[],framework:3,fuse:5,fusion:[1,5],infer:7,initi:[4,5,6,7,8],input:5,instal:3,jit:5,kernel:[1,5],larg:3,launcher:[4,6,7,8],licens:3,limit:5,list:1,load:[4,6,7,8],loader:4,make:[6,8],memori:5,memory_efficient_fus:1,merg:[6,7,8],model:[2,4,5,6,7,8],mpu:[6,8],multi:[6,8],note:3,offload_to_cpu:[],open:3,optim:[3,4,6,7,8],oslo:[3,4],parallel:[2,4,6,7,8],paralleliz:[6,8],partitioned_checkpoint:0,pytorch:4,sampler:[6,8],save:7,scale:3,some:[4,6,7,8],sourc:3,str:[],support:[2,5],tabl:[4,5,6,7,8],tensor:[5,6,7,8],tensor_parallel_s:2,token:[4,6,7,8],train:[4,6,7,8],transform:3,tutori:[4,5,6,7,8],unit:[6,8],usag:3,usual:[4,6,7,8],variabl:[4,6,7,8],warm:5,what:3,zero:8}})