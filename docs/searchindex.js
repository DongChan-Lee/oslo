Search.setIndex({docnames:["CONFIGURATION/activation_checkpointing","CONFIGURATION/kernel_fusion","CONFIGURATION/model_parallelism","TUTORIALS/activation_checkpointing","TUTORIALS/kernel_fusion","TUTORIALS/tensor_model_data_parallelism","TUTORIALS/tensor_model_parallelism","TUTORIALS/tensor_model_zero_data_parallelism","index"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["CONFIGURATION/activation_checkpointing.md","CONFIGURATION/kernel_fusion.md","CONFIGURATION/model_parallelism.md","TUTORIALS/activation_checkpointing.md","TUTORIALS/kernel_fusion.md","TUTORIALS/tensor_model_data_parallelism.md","TUTORIALS/tensor_model_parallelism.md","TUTORIALS/tensor_model_zero_data_parallelism.md","index.rst"],objects:{},objnames:{},objtypes:{},terms:{"0":[4,8],"02":8,"1":8,"10":[3,4,7],"100":[5,6,7],"1024":3,"12":3,"128":3,"15":8,"16":[2,4,6],"1885042190551758":4,"19448089599609375":4,"2":8,"2021":8,"2022":8,"20798110961914062":4,"21":8,"25":4,"256":4,"25797200202941895":4,"26519250869750977":4,"2x":4,"30":8,"3d":[5,7,8],"3e":[3,5,6,7],"4":2,"45142364501953125":4,"4gpu":6,"50":[5,6,7],"5e8":7,"64":[5,6,7],"681gib":3,"6b":8,"8":[2,6],"8594":3,"9":4,"break":[3,5,6,7],"case":4,"default":[0,1,2,4],"do":4,"function":[4,5,7],"import":[3,4,5,6,7,8],"long":4,"true":[3,4,5,6,7],"while":7,And:[5,6,7],As:3,Be:8,But:7,For:[3,5,6,7],If:[2,3,4,5,6,7,8],In:[3,4,6,7],It:[3,5,7,8],NOT:[5,7],The:[2,3,4,6,8],Then:6,There:6,_:[0,1,2,3,4,5,6,7],abl:4,about:[3,5],access:[5,7],activ:[4,8],activation_checkpoint:[0,3],actual:[5,7],ad:[7,8],adam:[3,5,6,7],add:[3,5,6,7],addit:[6,7],after:[5,6,7],agenc:8,ai:8,aica:8,albert:2,all:[2,4,5,7,8],allgather_bucket_s:7,allgather_partit:7,almost:2,alpha:8,alreadi:[3,5,7],also:[4,6],an:6,apach:8,appli:[5,7],ar:[0,1,2,3,4,5,7,8],architectur:4,area:4,argument:[5,6,7],artifici:8,author:8,automat:[5,7,8],automodelforcausallm:[3,5,6,7],autotoken:[3,5,6,7],avail:[0,1,3,4],avoid:3,backward:[3,4,5,6,7],bart:2,base:[3,8],batch:[1,3,4,5,6,7],batch_siz:[3,4,5,6,7],becaus:[4,5,6,7],begin:[5,7],being:8,bench:4,bert:2,better:4,bin:[5,6,7],bit:[5,6,7],blenderbot:2,blenderbotsmal:2,block:[1,4],boost:4,borrow:[5,7],bug:4,built:8,call:[3,4,5,7],can:[0,1,2,3,4,5,6,7,8],care:8,chang:3,check:7,checkpoint:[4,8],christma:6,classif:6,cluster:8,code:[3,4,5,6,7,8],com:8,command:8,commun:[5,7],compar:4,compat:[4,8],comput:4,concept:6,conclud:[3,4,5,6,7],config:[3,4,5,6,7,8],configur:[0,1,2],consid:8,constantli:7,context:[3,5,6,7],contigu:[0,3],contiguous_checkpoint:3,contiguous_gradi:7,continu:4,coordin:[5,7],copi:[5,7],copyright:8,core:8,could:[4,7,8],cpu:[0,3,7],cpu_checkpoint:3,crate:[5,6,7],creation:[5,6,7],cuda:[1,3,5,6,7],current:[1,2,4],current_devic:5,cusom:4,custom:1,custom_cuda_kernel:4,cut:4,data:[6,8],dataload:3,ddp:[5,7],de:8,decemb:8,decod:6,deepspe:[3,5,6,7],degre:2,depend:[4,8],deploy:8,describ:3,detail:2,determin:[5,7],develop:4,devic:[5,7],device_id:5,didn:4,differ:[4,5,7],distributeddataparallel:5,document:[3,5,6,7],doesn:[3,5,6,7],don:[2,6],dp:[5,7],e:[2,6],each:[5,7],easi:8,easier:4,easili:[5,7,8],effect:[1,4],effici:[1,3],electra:2,eleutherai:8,enabl:[4,5,6,7],engin:[3,4,5,7],enumer:[3,5,6,7],environ:[3,5,6,7],eos_token:[3,5,6,7],error:7,exampl:[4,6],execut:[1,4],expand:4,experiment:4,explan:[5,7],f:[3,4],face:[3,5,6,7,8],facilit:[5,7],fact:4,facto:8,fals:[0,1,2,3,5,7],famailar:7,faster:4,featur:[7,8],februari:8,feel:8,file:6,find:[2,8],finish:[5,7],first:[3,5,7],follow:[1,2,3,4,5,6,7,8],form:[5,6,7],forward:[3,5,6,7],found:[3,4,5,6,7],fp16:7,fragment:3,free:8,from:[2,3,4,5,6,7,8],from_parallel:[5,6,7],from_pretrain:[3,4,5,6,7],functorch:4,fusedgelu:4,fusednorepeatngram:[1,4],fusedrmsnorm:[1,4],fusibl:4,fusion:8,futur:[2,4],g:[2,6],gain:4,gener:[1,4,6],generationmixin:4,get_data_parallel_group:[5,7],get_data_parallel_rank:[5,7],get_data_parallel_world_s:[5,7],get_pipeline_parallel_group:[5,7],get_pipeline_parallel_rank:[5,7],get_pipeline_parallel_world_s:[5,7],get_rank:3,get_tensor_parallel_group:[5,7],get_tensor_parallel_rank:[5,7],get_tensor_parallel_world_s:[5,7],gib:3,github:8,gpt2:[2,3,4,5,6,7],gpt2config:[5,6,7],gpt2lmheadmodel:[4,5,6,7],gpt:8,gptj:2,gptneo:2,gpu:[1,2,3,4,5,6,7,8],gradient_checkpointing_en:3,graph:4,greater:6,group:[5,7],ha:[4,5,7],handcraft:4,have:[3,5,6,7],haven:[3,5,7],head:6,here:[2,3,4,5,6,7],hidden:6,how:[3,4,5,6,7],howev:[4,5,6,7],howpublish:8,http:8,hug:[3,5,6,7,8],huge:4,hyunwoong:8,i:[3,4,5,6,7],implement:3,improv:4,inc:8,includ:[2,4,5,7],incompat:4,industri:8,infer:[4,8],inform:[3,5,6,7],initi:8,input:[5,6,7],input_batch:[3,5,6,7],input_id:[3,5,6,7],input_tensor:4,insid:[5,7],instal:[3,5,6,7],instead:3,integr:3,intellig:8,introduc:[5,7],issu:[4,7],its:[5,7],j:8,januari:8,json:[5,6,7,8],just:[5,6,7],kei:8,kernel:8,kernel_fus:[1,4],kim:8,know:2,ko:8,kyubyong:8,label:[3,5,6,7],larg:[1,4],larger:3,later:[5,7],launch:[3,5,6,7],launcher:8,lee:8,let:[5,7],librari:[3,5,6,7],like:[0,1,2,3,4,5,6,7,8],likewis:6,line:8,list:2,ll:[5,7],lm:[5,6,7],load_dataset:[3,5,6,7],loader:[5,6,7],local:[5,6,7],look:[5,7],loss:[3,5,6,7],lot:6,lr:[3,5,6,7],m:[3,5,6,7],magic:8,mai:4,make:[3,4,6,8],manag:[5,7,8],mani:4,mark:4,mask:6,max_length:[3,5,6,7],mean:2,mechan:[4,5,7],megatron:[5,7],memori:[1,3],memory_alloc:3,memory_efficient_fus:4,merge_checkpoint:[5,6,7],merged_ckpt:[5,6,7],method:[4,5,6,7],min:4,misc:8,mix:[5,7],model:[0,8],model_parallel:[2,3,5,6,7],model_paramet:7,modul:5,more:[3,4,5,6,7],most:[3,4,7],much:4,multipl:[3,5,7],must:[2,3,5,6,7],name:[4,5,6,7,8],network:[5,7],ngram:[1,4],nice:[5,7],nn:5,no_repeat_ngram_s:4,non:4,non_oslo_model:4,note:[0,2,3,4,5,7],novel:4,now:[5,7,8],nproc_per_nod:[3,5,6,7],num:[5,7],num_beam:6,num_gpu:[3,5,6,7],num_replica:[5,7],num_your_gpu:[5,6,7],number:[2,6],nvidia:[5,7],object:[5,7],occur:[4,7],off:[5,7],offload:3,offload_optim:7,offload_param:7,okai:[5,6,7],one:6,ones:4,onli:[0,3,4,5,7,8],optim:4,oslo:[4,5,6,7],oslo_model:4,other:4,our:[4,8],output_devic:5,overlap_comm:7,own:[0,1,2,5,7],packag:[3,8],pad:[3,5,6,7],pad_token:[3,5,6,7],paper:3,parallel:[0,4,8],parallel_ckpt:[5,6,7],param:7,paramet:[3,5,6,7],park:8,part:[3,4],partit:[0,3],partitioned_checkpoint:3,path:[5,6,7],perform:4,piec:[5,7],pip:8,pipelin:[5,7],pipeline_parallel_s:[5,7],place:[5,7],pleas:[3,4,5,7,8],polici:4,posit:[2,6],possibl:4,power:[2,4,6],previou:[5,7],print:[3,4,6],process:[5,6,7],process_group:5,project:8,provid:[4,5,7,8],pt:[3,5,6,7],py:[3,5,6,7],pypi:8,python:[3,5,6,7],pytorch:[4,5,6,7],pytorch_model:[5,6,7],pytorch_model_tp_0_pp_0:6,randomli:[5,6,7],rang:4,rank:[5,7],rather:4,re:[5,7],read:[3,5,7],readi:[5,7],reason:[5,7],receiv:[5,7],recommend:[5,6,7],reduce_bucket_s:7,reduce_scatt:7,refer:[3,5,6,7],relat:[0,1,2],releas:8,remateri:4,replic:[5,7],report:[4,7],requir:4,reserv:8,respect:[5,7],result:[3,4,5,7],return_tensor:[3,5,6,7],right:8,rmsnorm:[1,4],roberta:2,round:3,rule:2,runtim:4,s:[1,4,5,6,7],same:[2,3,4,5,6,7],save:[3,5,7],save_directori:[5,6,7],save_interv:[5,6,7],save_parallel:[5,6,7],save_pretrain:6,scenario:4,schedul:7,script:4,section:[4,5,7],see:3,seen:[5,7],segment:[5,7],send:[5,7],seq_len:[3,4,5,6,7],sequenc:6,set:[4,5,6,7],sever:4,should:[4,5,7,8],show:4,shuffl:[3,5,6,7],similar:6,simpl:4,singl:[5,7,8],size:[2,3,5,6,7],skip:[5,7],slow:[5,6,7],smaller:[2,5,6,7],so:[3,4,5,6,7],some:2,soohwan:8,sourc:[3,4,5,6,7],special:[5,6,7],specif:4,specifi:[0,1,2,5,7],speed:4,split:[5,7],squad:[3,5,6,7],stage:7,standard:8,start:4,step:[3,5,6,7],still:4,str:[3,5,6,7],support:[1,5,6,7,8],suppos:[5,7],t5:[1,2,4],t5forconditionalgener:4,t:[2,3,4,5,6,7],take:[5,7,8],task:6,team:4,technolog:[4,8],tensor:[0,2,3,8],tensor_parallel_s:[3,5,6,7],term:8,text:[1,4,6],than:[2,4,5,6,7],thank:[3,4,5,6,7],thei:[5,7],them:[5,6,7],therefor:[5,7],thi:[0,2,3,4,5,6,7],thing:6,through:7,time:[4,5,7],titl:8,togeth:7,torch:[3,4,5,6,7,8],total:[2,5,6,7],total_num_step:7,tp:[5,7],tracker:4,train:[4,8],train_batch_s:7,train_step:[3,5,6,7],transform:[3,4,5,6,7],truncat:[3,5,6,7],tunib:8,ture:[5,6,7],turn:[5,7],twice:3,two:[4,5,7],type:[0,1,2,7],under:[0,1,2,4,8],unexpect:4,unfamiliar:[3,5,7],url:8,us:[0,1,3,4,5,6,7,8],use_cach:3,util:[3,5,6,7],vari:4,variou:[6,7,8],veri:[1,4],version:8,wa:[5,7],want:[4,6],warmup_max_lr:7,warmup_min_lr:7,warmup_num_step:7,warmupdecaylr:7,we:[2,4,5,6,7],weight_decai:7,what:2,when:[0,1,3,4,5,7,8],which:8,without:3,work:[3,5,6,7,8],world:[5,7],would:[5,7],write:6,www:8,year:8,yohan:8,you:[0,1,2,3,4,5,6,7,8],your:[0,1,2,3,4,5,6,7],your_script:[3,5,6,7],your_tensor_parallel_s:[3,5,7],zero:8,zero_grad:[3,5,6,7],zero_optim:7},titles:["Activation Checkpointing","Kernel Fusion","Model Parallelism","Activation Checkpointing Tutorial","Kernel Fusion Tutorial","Tensor Model + Data Parallelism Tutorial","Tensor Model Parallelism Tutorial","Tensor Model + ZeRO Data Parallelism Tutorial","OSLO: Open Source framework for Large-scale transformer Optimization"],titleterms:{"0":[3,5,6,7],"1":[0,1,2,3,4,5,6,7],"2":[0,1,2,3,4,5,6,7],"3":[0,1,3,4,5,6,7],"4":[0,3,4,5,6,7],"5":[3,4,5,6,7],"6":[3,4,5,6,7],"7":[5,7],"8":[5,7],"do":[3,5,6,7],"int":2,"new":8,The:[5,7],about:8,acknowledg:8,activ:[0,3],administr:8,aot:4,autograd:4,base:4,basic:8,benchmark:4,bool:[0,1,2],checkpoint:[0,3,5,6,7],cite:8,compil:4,concept:[5,7],configur:8,content:[3,4,5,6,7],contiguous_checkpoint:0,cpu_checkpoint:0,creat:[3,4,5,6,7],cuda:4,custom:4,custom_cuda_kernel:1,data:[3,5,7],dataload:[5,6,7],dataset:[3,5,6,7],dimension:[5,7],distribut:[3,5,6,7],distributedsampl:[5,7],document:8,effici:4,enabl:[0,1,2,3],framework:8,fuse:4,fusion:[1,4],infer:6,initi:[3,4,5,6,7],input:4,instal:8,jit:4,kernel:[1,4],larg:8,launcher:[3,5,6,7],licens:8,limit:4,list:1,load:[3,5,6,7],loader:3,make:[5,7],memori:4,memory_efficient_fus:1,merg:[5,6,7],model:[2,3,4,5,6,7],mpu:[5,7],multi:[5,7],note:8,open:8,optim:[3,5,6,7,8],oslo:[3,8],parallel:[2,3,5,6,7],paralleliz:[5,7],partitioned_checkpoint:0,pytorch:3,s:8,sampler:[5,7],save:6,scale:8,some:[3,5,6,7],sourc:8,support:[2,4],tabl:[3,4,5,6,7],tensor:[4,5,6,7],tensor_parallel_s:2,token:[3,5,6,7],train:[3,5,6,7],transform:8,tutori:[3,4,5,6,7,8],unit:[5,7],up:4,usag:8,usual:[3,5,6,7],variabl:[3,5,6,7],warm:4,what:8,zero:7}})